{"pageProps":{"html":"<h1 dir=\"auto\">element.scrollTo方法使用与兼容</h1>\n<blockquote>\n<p dir=\"auto\">在工作中碰到控制滚动条滚动的需求，原有代码使用scrollTo进行滚动，在现代浏览器上都可以正常运行，但是到了IE11上却不行了，于是对scrollTo做了一层小小的封装。于是在这里分享一下...</p>\n</blockquote>\n<h2 dir=\"auto\">window.scrollTo</h2>\n<p dir=\"auto\">关于在document上滚动的问题，直接可以使用<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollTo\" rel=\"nofollow\">window.scrollTo</a>方法，用法如下：</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  var x = 0, y = 100\n  window.scrollTo(x, y)\"><pre>  <span class=\"pl-k\">var</span> <span class=\"pl-s1\">x</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">0</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">y</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">100</span>\n  <span class=\"pl-smi\">window</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">scrollTo</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">x</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">y</span><span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">在mdn上说明了，如果想对elements进行滚动条操作，可以使用<code class=\"notranslate\">element.scrollTop</code>和<code class=\"notranslate\">scrollLeft</code>。<br>\n在这里要补充说明一下<code class=\"notranslate\">element.scrollTo</code>方法</p>\n<h2 dir=\"auto\">element.scrollTo</h2>\n<p dir=\"auto\"><code class=\"notranslate\">element.scrollTo</code>方法也是无意间发现，mdn和caniuse上是没有对该方法进行说明的。<br>\n该方法入参与window上的scrollTo一致，用法如下：</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"var $el = document.querySelector('#container')\nvar x = 0, y = 100\n$el.scrollTo(x, y)\"><pre><span class=\"pl-k\">var</span> <span class=\"pl-s1\">$el</span> <span class=\"pl-c1\">=</span> <span class=\"pl-smi\">document</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">querySelector</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'#container'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">var</span> <span class=\"pl-s1\">x</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">0</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">y</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">100</span>\n<span class=\"pl-s1\">$el</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">scrollTo</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">x</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">y</span><span class=\"pl-kos\">)</span></pre></div>\n<h2 dir=\"auto\">兼容性问题</h2>\n<p dir=\"auto\"><code class=\"notranslate\">window.scrollTo</code>的兼容性如下<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/17166940/94903476-76542e80-04cc-11eb-8a1e-a2e3f9e6808d.png\"><img src=\"https://user-images.githubusercontent.com/17166940/94903476-76542e80-04cc-11eb-8a1e-a2e3f9e6808d.png\" alt=\"image\" style=\"max-width: 100%;\"></a></p>\n<p dir=\"auto\"><code class=\"notranslate\">window.scrollTo</code>看上去十分理想，但是<code class=\"notranslate\">element.scrollTo</code>就没那么理想化了。</p>\n<p dir=\"auto\"><a href=\"https://github.com/Fyrd/caniuse/issues/4251\" data-hovercard-type=\"issue\" data-hovercard-url=\"/Fyrd/caniuse/issues/4251/hovercard\">这位小哥</a>测试了Chrome, Chrome66支持element.scrollTo, Chrome48不支持</p>\n<p dir=\"auto\">经过几个主流浏览器的测试之后，发现IE 11下的<code class=\"notranslate\">element.scrollTo</code>为<code class=\"notranslate\">undefined</code>。</p>\n<p dir=\"auto\">这里我简单封装了一下scrollTo，做了一个小小的polyfill。代码如下：</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"/**\n * polyfill for scrollTo on element\n * @param {HtmlElement} el\n * @param {number} x\n * @param {number} y\n */\nfunction scrollTo (el, x, y) {\n  if (!el) {\n    return\n  }\n\n  if (el.scrollTo) {\n    el.scrollTo(x, y)\n  } else {\n    el.scrollLeft = x\n    el.scrollTop = y\n  }\n}\"><pre><span class=\"pl-c\">/**</span>\n<span class=\"pl-c\"> * polyfill for scrollTo on element</span>\n<span class=\"pl-c\"> * <span class=\"pl-k\">@param</span> {<span class=\"pl-smi\">HtmlElement</span>} el</span>\n<span class=\"pl-c\"> * <span class=\"pl-k\">@param</span> {<span class=\"pl-smi\">number</span>} x</span>\n<span class=\"pl-c\"> * <span class=\"pl-k\">@param</span> {<span class=\"pl-smi\">number</span>} y</span>\n<span class=\"pl-c\"> */</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-en\">scrollTo</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">el</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">x</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">y</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">!</span><span class=\"pl-s1\">el</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">return</span>\n  <span class=\"pl-kos\">}</span>\n\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">el</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollTo</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-s1\">el</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">scrollTo</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">x</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">y</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">}</span> <span class=\"pl-k\">else</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-s1\">el</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollLeft</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">x</span>\n    <span class=\"pl-s1\">el</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollTop</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">y</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">这里也简单说明下scrollLeft和scrollTop做滚动条操作的用法<br>\n如果滚动条在容器最底部，假设$el为容器</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$el.clientHeight + $el.scrollTop === $el.scrollHeight // true\"><pre><span class=\"pl-s1\">$el</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">clientHeight</span> <span class=\"pl-c1\">+</span> <span class=\"pl-s1\">$el</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollTop</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s1\">$el</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollHeight</span> <span class=\"pl-c\">// true</span></pre></div>\n<p dir=\"auto\">scrollTop可以理解为滚动条距离容器顶部的距离，当然其实这里有很大的坑。<br>\n具体可以看mdn的scrollTop描述。</p>\n<p dir=\"auto\">那scrollLeft就是滚动条距离容器左侧的距离了。</p>\n<p dir=\"auto\">那其实scrollLeft = 0就等价于滚动条在最左边，scrollTop = 0就等价于滚动条在最顶层。<br>\nscrollLeft就是原有api参数中的x，scrollTop就是原有api参数中的y。</p>\n<h2 dir=\"auto\">Reference</h2>\n<p dir=\"auto\"><a href=\"https://www.w3.org/TR/cssom-view-1/#extension-to-the-element-interface\" rel=\"nofollow\">https://www.w3.org/TR/cssom-view-1/#extension-to-the-element-interface</a></p>\n<p dir=\"auto\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollTo\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollTo</a></p>\n<p dir=\"auto\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTop\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTop</a></p>\n<p dir=\"auto\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollLeft\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollLeft</a></p>"},"__N_SSG":true}