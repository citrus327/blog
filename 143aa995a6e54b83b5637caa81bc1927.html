<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="description" content="React Notion X Minimal Demo"/><title>rollup 打包 _export is not defined 问题解决方案</title><meta name="next-head-count" content="4"/><link rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/blog/_next/static/css/e80d3da29db4d5c2.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/e80d3da29db4d5c2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script defer="" src="/blog/_next/static/chunks/94b3d469.01f0b81f57fec31d.js"></script><script defer="" src="/blog/_next/static/chunks/78.e2fa1ad1735022d1.js"></script><script defer="" src="/blog/_next/static/chunks/785.f9522e486e3cf112.js"></script><script src="/blog/_next/static/chunks/webpack-c10d1318d0451db8.js" defer=""></script><script src="/blog/_next/static/chunks/framework-459f2affe0a6a60f.js" defer=""></script><script src="/blog/_next/static/chunks/main-12dc9115bd27a2f8.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-ca60221c825fc339.js" defer=""></script><script src="/blog/_next/static/chunks/571-e33bda93c073246d.js" defer=""></script><script src="/blog/_next/static/chunks/pages/%5BpageId%5D-c9611068cade4702.js" defer=""></script><script src="/blog/_next/static/8m1jH_cEAcI8D4q1R7pJI/_buildManifest.js" defer=""></script><script src="/blog/_next/static/8m1jH_cEAcI8D4q1R7pJI/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="notion notion-app light-mode notion-block-143aa995a6e54b83b5637caa81bc1927"><div class="notion-viewport"></div><div class="notion-frame"><header class="notion-header"><div class="notion-nav-header"><div class="breadcrumbs"><a class="breadcrumb" href="/blog/35a3a4f93d7a4cb89e0f18ed63907dcf"><div class="notion-page-icon-inline notion-page-icon-span"><img class="icon notion-page-icon" src="https://www.notion.so/icons/glasses_red.svg?mode=light" alt="Citrus327’s Blog" loading="lazy" decoding="async"/></div><span class="title">Citrus327’s Blog</span></a><span class="spacer">/</span><div class="breadcrumb active"><span class="title">rollup 打包 _export is not defined 问题解决方案</span></div></div></div></header><div class="notion-page-scroller"><main class="notion-page notion-page-no-cover notion-page-no-icon notion-page-has-text-icon notion-full-page"><h1 class="notion-title">rollup 打包 _export is not defined 问题解决方案</h1><!--$--><div class="notion-collection-page-properties"><div class="notion-collection-row"><div class="notion-collection-row-body"></div></div></div><!--/$--><div class="notion-page-content"><article class="notion-page-content-inner"><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-e7fa0a7734f446ca97b99e47cd4575c2" data-id="e7fa0a7734f446ca97b99e47cd4575c2"><span><div id="e7fa0a7734f446ca97b99e47cd4575c2" class="notion-header-anchor"></div><a class="notion-hash-link" href="#e7fa0a7734f446ca97b99e47cd4575c2" title="rollup 打包 _export is not defined 问题解决方案"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">rollup 打包 _export is not defined 问题解决方案</span></span></h2><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-489a82f5020447f897f08c042a475690" data-id="489a82f5020447f897f08c042a475690"><span><div id="489a82f5020447f897f08c042a475690" class="notion-header-anchor"></div><a class="notion-hash-link" href="#489a82f5020447f897f08c042a475690" title="Rollup 配置"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Rollup 配置</span></span></h3><!--$--><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">import { babel } from &quot;@rollup/plugin-babel&quot;;
import commonjs from &quot;@rollup/plugin-commonjs&quot;;
import resolve from &quot;@rollup/plugin-node-resolve&quot;;
import url from &quot;@rollup/plugin-url&quot;;
import external from &quot;rollup-plugin-peer-deps-external&quot;;
import postcss from &quot;rollup-plugin-postcss&quot;;
import typescript from &quot;rollup-plugin-typescript&quot;;
import pkg from &quot;./package.json&quot;;

const config = {
  input: &quot;src/index.ts&quot;,
  output: [
    {
      file: pkg.main,
      format: &quot;cjs&quot;,
      exports: &quot;named&quot;,
    },
    {
      file: pkg.module,
      format: &quot;es&quot;,
      exports: &quot;named&quot;,
    },
  ],
  plugins: [
    resolve(),
    commonjs(),
    postcss({
      plugins: [],
      minimize: true,
    }),
    external({
      includeDependencies: false,
    }),
    babel({
      babelHelpers: &quot;bundled&quot;,
      presets: [
        [
          &quot;@babel/preset-env&quot;,
          {
            useBuiltIns: &quot;usage&quot;,
            corejs: 3,
          },
        ],
      ],
    }),
    url(),
    typescript({ tsconfig: &quot;./tsconfig.json&quot; }),
  ],
};

export default config;</code></pre><!--/$--><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-6467997318cd4c5793a810828071e9f7" data-id="6467997318cd4c5793a810828071e9f7"><span><div id="6467997318cd4c5793a810828071e9f7" class="notion-header-anchor"></div><a class="notion-hash-link" href="#6467997318cd4c5793a810828071e9f7" title="问题"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">问题</span></span></h3><div class="notion-text notion-block-0a1105c14eea479fa620472ac3f96627">报出 <code class="notion-inline-code">$$1w is not defined</code>，实际查证是$$1w 指向了<code class="notion-inline-code">_export</code>这个方法。而<code class="notion-inline-code">_export</code>的定义在最下方。</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-67fc9fa4cc264cb0bee2cb5dd14839e2" data-id="67fc9fa4cc264cb0bee2cb5dd14839e2"><span><div id="67fc9fa4cc264cb0bee2cb5dd14839e2" class="notion-header-anchor"></div><a class="notion-hash-link" href="#67fc9fa4cc264cb0bee2cb5dd14839e2" title="原因"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">原因</span></span></h3><div class="notion-text notion-block-bf8893879616471d97b0d237c42f0d8c">根据以下 Issue</div><ol start="1" class="notion-list notion-list-numbered notion-block-314e3af434fd44d3bc1a652d86a29013"><li>https://github.com/rollup/plugins/issues/466</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-bcb3e56c98ef4d86956dfca8584fd2a6"><li>https://github.com/rollup/rollup/issues/3802</li></ol><div class="notion-text notion-block-7d4f6173077840f49c84b29ef7ae8360">原因是当打包 dependencies 时，core-js 本身会被 babel 再解析一遍，造成循环引用。</div><div class="notion-text notion-block-2954bac8f6e94870a4bf8b3f3e017835">Quote:</div><blockquote class="notion-quote notion-block-619769f2046d49bfa567224c693c4e88"><div>You need to exclude core-js from babel or @babel/preset-env with useBuiltins: ‘usage’ will create a circular reference trying to process core-js itself:</div></blockquote><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-cbc85591379a4003b2d05b1c20d3761f" data-id="cbc85591379a4003b2d05b1c20d3761f"><span><div id="cbc85591379a4003b2d05b1c20d3761f" class="notion-header-anchor"></div><a class="notion-hash-link" href="#cbc85591379a4003b2d05b1c20d3761f" title="解决方案"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">解决方案</span></span></h3><ol start="1" class="notion-list notion-list-numbered notion-block-b8e6a4a2f1c8432ea5128fac2e76c277"><li>external 插件配置<code class="notion-inline-code">includeDependencies: true</code>, 产物不打包 core-js</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-1231ad59378f4f6ca0a507400e1ffe3d"><li>babel 插件 exclude core-js</li></ol><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-f729b86528354d0bb3d0c6c6bffdbd5d" data-id="f729b86528354d0bb3d0c6c6bffdbd5d"><span><div id="f729b86528354d0bb3d0c6c6bffdbd5d" class="notion-header-anchor"></div><a class="notion-hash-link" href="#f729b86528354d0bb3d0c6c6bffdbd5d" title="结果"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">结果</span></span></h3><!--$--><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">external({
  includeDependencies: false,
}),
babel({
  babelHelpers: &quot;bundled&quot;,
  exclude: [/core-js/],
  presets: [
    [
      &quot;@babel/preset-env&quot;,
      {
        useBuiltIns: &quot;usage&quot;,
        corejs: 3,
      },
    ],
  ],
});</code></pre><!--/$--><div class="notion-text notion-block-dfab45b9fc3d4b538bd438a7f2291857">或者</div><!--$--><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">external({
  includeDependencies: true,
}),
babel({
  babelHelpers: &quot;bundled&quot;,
  presets: [
    [
      &quot;@babel/preset-env&quot;,
      {
        useBuiltIns: &quot;usage&quot;,
        corejs: 3,
      },
    ],
  ],
});</code></pre><!--/$--></article></div></main></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"recordMap":{"block":{"143aa995-a6e5-4b83-b563-7caa81bc1927":{"role":"reader","value":{"id":"143aa995-a6e5-4b83-b563-7caa81bc1927","version":8,"type":"page","properties":{"title":[["rollup 打包 _export is not defined 问题解决方案"]]},"content":["e7fa0a77-34f4-46ca-97b9-9e47cd4575c2","489a82f5-0204-47f8-97f0-8c042a475690","5efd2109-11e1-4a48-9dbd-00d423aa8147","64679973-18cd-4c57-93a8-10828071e9f7","0a1105c1-4eea-479f-a620-472ac3f96627","67fc9fa4-cc26-4cb0-bee2-cb5dd14839e2","bf889387-9616-471d-97b0-d237c42f0d8c","314e3af4-34fd-44d3-bc1a-652d86a29013","bcb3e56c-98ef-4d86-956d-fca8584fd2a6","7d4f6173-0778-40f4-9c84-b29ef7ae8360","2954bac8-f6e9-4870-a4bf-8b3f3e017835","619769f2-046d-49bf-a567-224c693c4e88","cbc85591-379a-4003-b2d0-5b1c20d3761f","b8e6a4a2-f1c8-432e-a512-8fac2e76c277","1231ad59-378f-4f6c-a0a5-07400e1ffe3d","f729b865-2835-4d0b-b3d0-c6c6bffdbd5d","f2908c2c-1679-4669-8784-8fa5df8f75b2","dfab45b9-fc3d-4b53-8bd4-38a7f2291857","e4d47fac-81ab-4b14-936a-0018c8b3488d"],"created_time":1673275111453,"last_edited_time":1673276789372,"parent_id":"7c5b4e39-cf12-4d8c-986c-cff290eee407","parent_table":"collection","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"720fa796-e2d6-42db-ac52-1fee3d19addd":{"role":"reader","value":{"id":"720fa796-e2d6-42db-ac52-1fee3d19addd","version":138,"type":"collection_view","view_ids":["97e7d4c0-30d1-4f1c-a393-bb0306148ce7","c5d58f05-b0cc-4b2b-b545-f1fd5df549fb"],"collection_id":"7c5b4e39-cf12-4d8c-986c-cff290eee407","format":{"block_locked":true,"block_locked_by":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","collection_pointer":{"id":"7c5b4e39-cf12-4d8c-986c-cff290eee407","table":"collection","spaceId":"11f66c5f-6043-406b-b492-4dc267645668"},"page_cover_position":0.6},"created_time":1673273881211,"last_edited_time":1673609816936,"parent_id":"35a3a4f9-3d7a-4cb8-9e0f-18ed63907dcf","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"35a3a4f9-3d7a-4cb8-9e0f-18ed63907dcf":{"role":"reader","value":{"id":"35a3a4f9-3d7a-4cb8-9e0f-18ed63907dcf","version":270,"type":"page","properties":{"title":[["Citrus327’s Blog"]]},"content":["aa6b97de-ddd6-4b90-988f-e783bc91bd90","720fa796-e2d6-42db-ac52-1fee3d19addd","1e734c6c-9054-4c36-b6dc-a3ec045eaa2b"],"format":{"page_icon":"/icons/glasses_red.svg","page_cover":"/images/page-cover/solid_yellow.png","copied_from_pointer":{"id":"78754261-97cf-4616-9880-9def95960ebf","table":"block","spaceId":"fde5ac74-eea3-4527-8f00-4482710e1af3"},"page_cover_position":0.6},"permissions":[{"role":"editor","type":"user_permission","user_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a"},{"role":"reader","type":"public_permission","added_timestamp":1673037428832}],"created_time":1673036763269,"last_edited_time":1673609823777,"parent_id":"11f66c5f-6043-406b-b492-4dc267645668","parent_table":"space","alive":true,"copied_from":"78754261-97cf-4616-9880-9def95960ebf","file_ids":["f70d3dc6-ce97-4be2-9cde-b86606147b41","a2bd3317-78e4-48bc-8d27-9b733175a416","747fe148-54f4-48ba-b7c0-dfb2bf5b9b96","ff661d2b-c27d-4552-9892-477f2d7b33b9"],"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"e7fa0a77-34f4-46ca-97b9-9e47cd4575c2":{"role":"reader","value":{"id":"e7fa0a77-34f4-46ca-97b9-9e47cd4575c2","version":1,"type":"header","properties":{"title":[["rollup 打包 _export is not defined 问题解决方案"]]},"created_time":1673275111434,"last_edited_time":1673275111434,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"489a82f5-0204-47f8-97f0-8c042a475690":{"role":"reader","value":{"id":"489a82f5-0204-47f8-97f0-8c042a475690","version":1,"type":"sub_header","properties":{"title":[["Rollup 配置"]]},"created_time":1673275111440,"last_edited_time":1673275111440,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"5efd2109-11e1-4a48-9dbd-00d423aa8147":{"role":"reader","value":{"id":"5efd2109-11e1-4a48-9dbd-00d423aa8147","version":6,"type":"code","properties":{"title":[["import { babel } from \"@rollup/plugin-babel\";\nimport commonjs from \"@rollup/plugin-commonjs\";\nimport resolve from \"@rollup/plugin-node-resolve\";\nimport url from \"@rollup/plugin-url\";\nimport external from \"rollup-plugin-peer-deps-external\";\nimport postcss from \"rollup-plugin-postcss\";\nimport typescript from \"rollup-plugin-typescript\";\nimport pkg from \"./package.json\";\n\nconst config = {\n  input: \"src/index.ts\",\n  output: [\n    {\n      file: pkg.main,\n      format: \"cjs\",\n      exports: \"named\",\n    },\n    {\n      file: pkg.module,\n      format: \"es\",\n      exports: \"named\",\n    },\n  ],\n  plugins: [\n    resolve(),\n    commonjs(),\n    postcss({\n      plugins: [],\n      minimize: true,\n    }),\n    external({\n      includeDependencies: false,\n    }),\n    babel({\n      babelHelpers: \"bundled\",\n      presets: [\n        [\n          \"@babel/preset-env\",\n          {\n            useBuiltIns: \"usage\",\n            corejs: 3,\n          },\n        ],\n      ],\n    }),\n    url(),\n    typescript({ tsconfig: \"./tsconfig.json\" }),\n  ],\n};\n\nexport default config;"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1673275111443,"last_edited_time":1673275636728,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"64679973-18cd-4c57-93a8-10828071e9f7":{"role":"reader","value":{"id":"64679973-18cd-4c57-93a8-10828071e9f7","version":1,"type":"sub_header","properties":{"title":[["问题"]]},"created_time":1673275111444,"last_edited_time":1673275111444,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"0a1105c1-4eea-479f-a620-472ac3f96627":{"role":"reader","value":{"id":"0a1105c1-4eea-479f-a620-472ac3f96627","version":1,"type":"text","properties":{"title":[["报出 "],["$$1w is not defined",[["c"]]],["，实际查证是$$1w 指向了"],["_export",[["c"]]],["这个方法。而"],["_export",[["c"]]],["的定义在最下方。"]]},"created_time":1673275111446,"last_edited_time":1673275111446,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"67fc9fa4-cc26-4cb0-bee2-cb5dd14839e2":{"role":"reader","value":{"id":"67fc9fa4-cc26-4cb0-bee2-cb5dd14839e2","version":1,"type":"sub_header","properties":{"title":[["原因"]]},"created_time":1673275111446,"last_edited_time":1673275111446,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"bf889387-9616-471d-97b0-d237c42f0d8c":{"role":"reader","value":{"id":"bf889387-9616-471d-97b0-d237c42f0d8c","version":1,"type":"text","properties":{"title":[["根据以下 Issue"]]},"created_time":1673275111446,"last_edited_time":1673275111446,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"314e3af4-34fd-44d3-bc1a-652d86a29013":{"role":"reader","value":{"id":"314e3af4-34fd-44d3-bc1a-652d86a29013","version":1,"type":"numbered_list","properties":{"title":[["https://github.com/rollup/plugins/issues/466"]]},"created_time":1673275111447,"last_edited_time":1673275111447,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"bcb3e56c-98ef-4d86-956d-fca8584fd2a6":{"role":"reader","value":{"id":"bcb3e56c-98ef-4d86-956d-fca8584fd2a6","version":1,"type":"numbered_list","properties":{"title":[["https://github.com/rollup/rollup/issues/3802"]]},"created_time":1673275111447,"last_edited_time":1673275111447,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"7d4f6173-0778-40f4-9c84-b29ef7ae8360":{"role":"reader","value":{"id":"7d4f6173-0778-40f4-9c84-b29ef7ae8360","version":1,"type":"text","properties":{"title":[["原因是当打包 dependencies 时，core-js 本身会被 babel 再解析一遍，造成循环引用。"]]},"created_time":1673275111448,"last_edited_time":1673275111448,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"2954bac8-f6e9-4870-a4bf-8b3f3e017835":{"role":"reader","value":{"id":"2954bac8-f6e9-4870-a4bf-8b3f3e017835","version":1,"type":"text","properties":{"title":[["Quote:"]]},"created_time":1673275111448,"last_edited_time":1673275111448,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"619769f2-046d-49bf-a567-224c693c4e88":{"role":"reader","value":{"id":"619769f2-046d-49bf-a567-224c693c4e88","version":1,"type":"quote","properties":{"title":[["You need to exclude core-js from babel or @babel/preset-env with useBuiltins: ‘usage’ will create a circular reference trying to process core-js itself:"]]},"created_time":1673275111449,"last_edited_time":1673275111449,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"cbc85591-379a-4003-b2d0-5b1c20d3761f":{"role":"reader","value":{"id":"cbc85591-379a-4003-b2d0-5b1c20d3761f","version":1,"type":"sub_header","properties":{"title":[["解决方案"]]},"created_time":1673275111449,"last_edited_time":1673275111449,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"b8e6a4a2-f1c8-432e-a512-8fac2e76c277":{"role":"reader","value":{"id":"b8e6a4a2-f1c8-432e-a512-8fac2e76c277","version":1,"type":"numbered_list","properties":{"title":[["external 插件配置"],["includeDependencies: true",[["c"]]],[", 产物不打包 core-js"]]},"created_time":1673275111450,"last_edited_time":1673275111450,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"1231ad59-378f-4f6c-a0a5-07400e1ffe3d":{"role":"reader","value":{"id":"1231ad59-378f-4f6c-a0a5-07400e1ffe3d","version":1,"type":"numbered_list","properties":{"title":[["babel 插件 exclude core-js"]]},"created_time":1673275111450,"last_edited_time":1673275111450,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"f729b865-2835-4d0b-b3d0-c6c6bffdbd5d":{"role":"reader","value":{"id":"f729b865-2835-4d0b-b3d0-c6c6bffdbd5d","version":1,"type":"sub_header","properties":{"title":[["结果"]]},"created_time":1673275111450,"last_edited_time":1673275111450,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"f2908c2c-1679-4669-8784-8fa5df8f75b2":{"role":"reader","value":{"id":"f2908c2c-1679-4669-8784-8fa5df8f75b2","version":28,"type":"code","properties":{"title":[["external({\n  includeDependencies: false,\n}),\nbabel({\n  babelHelpers: \"bundled\",\n  exclude: [/core-js/],\n  presets: [\n    [\n      \"@babel/preset-env\",\n      {\n        useBuiltIns: \"usage\",\n        corejs: 3,\n      },\n    ],\n  ],\n});"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1673275111451,"last_edited_time":1673275651673,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"dfab45b9-fc3d-4b53-8bd4-38a7f2291857":{"role":"reader","value":{"id":"dfab45b9-fc3d-4b53-8bd4-38a7f2291857","version":1,"type":"text","properties":{"title":[["或者"]]},"created_time":1673275111452,"last_edited_time":1673275111452,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"e4d47fac-81ab-4b14-936a-0018c8b3488d":{"role":"reader","value":{"id":"e4d47fac-81ab-4b14-936a-0018c8b3488d","version":19,"type":"code","properties":{"title":[["external({\n  includeDependencies: true,\n}),\nbabel({\n  babelHelpers: \"bundled\",\n  presets: [\n    [\n      \"@babel/preset-env\",\n      {\n        useBuiltIns: \"usage\",\n        corejs: 3,\n      },\n    ],\n  ],\n});"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1673275111452,"last_edited_time":1673275663082,"parent_id":"143aa995-a6e5-4b83-b563-7caa81bc1927","parent_table":"block","alive":true,"ignore_block_count":true,"created_by_table":"notion_user","created_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","last_edited_by_table":"notion_user","last_edited_by_id":"655f56a9-2482-4fed-ae6d-9f23ccbb923a","space_id":"11f66c5f-6043-406b-b492-4dc267645668"}}},"collection":{"7c5b4e39-cf12-4d8c-986c-cff290eee407":{"role":"reader","value":{"id":"7c5b4e39-cf12-4d8c-986c-cff290eee407","version":47,"name":[["Posts"]],"schema":{";nHF":{"name":"Created time","type":"created_time"},"\u003e:DV":{"name":"Published","type":"checkbox"},"VeZ_":{"name":"Private","type":"checkbox"},"Zq\u003e}":{"name":"Featured","type":"checkbox"},"rTD}":{"name":"Tags","type":"multi_select","options":[{"id":"33b90624-5bb0-463f-b4e6-43a173ffe028","color":"pink","value":"Life"}]},"s?]n":{"name":"Last edited time","type":"last_edited_time"},"title":{"name":"Title","type":"title"}},"cover":"/images/page-cover/solid_beige.png","format":{"property_visibility":[{"property":"rTD}","visibility":"hide"},{"property":";nHF","visibility":"hide"},{"property":"Zq\u003e}","visibility":"hide"},{"property":"s?]n","visibility":"hide"},{"property":"VeZ_","visibility":"hide"},{"property":"\u003e:DV","visibility":"hide"}],"collection_cover_position":0.5,"collection_page_properties":[{"visible":true,"property":"rTD}"}]},"parent_id":"720fa796-e2d6-42db-ac52-1fee3d19addd","parent_table":"block","alive":true,"migrated":true,"space_id":"11f66c5f-6043-406b-b492-4dc267645668","deleted_schema":{"ElLO":{"name":"Date","type":"date"},"KJ}\\":{"name":"Created time 1","type":"created_time"},"_}UF":{"name":"Date","type":"date"}}}}},"collection_view":{"97e7d4c0-30d1-4f1c-a393-bb0306148ce7":{"role":"reader","value":{"id":"97e7d4c0-30d1-4f1c-a393-bb0306148ce7","version":4,"type":"gallery","name":"Featured","format":{"gallery_cover":{"type":"page_cover"},"property_filters":[{"id":"76d07a2c-1674-4c5e-9a09-84428c965a95","filter":{"filter":{"value":{"type":"exact","value":true},"operator":"checkbox_is"},"property":"Zq\u003e}"}}],"hide_linked_collection_name":true},"parent_id":"720fa796-e2d6-42db-ac52-1fee3d19addd","parent_table":"block","alive":true,"page_sort":["19be9c2d-64ff-4c8a-8135-571eb833f289","2d0a5101-7003-4092-9057-19b8afad5b47","f035a5d3-a3cc-4c7f-a807-1ef1adf3d793","549e0e14-1265-41ed-b0e8-6cd266e689f0","2cabcd1c-9b22-40e5-ac11-49c6807ab8f7","39be2719-fb58-49f3-a7fc-6d1c9ca86757","5d2d521a-e821-4acd-b0db-1e0ace950295","129181e5-5b2d-40a5-af60-47c125f075fd","455dfe03-94f5-4179-a5d7-528c072d34c4","08afc86f-001a-4e35-a008-dae3063a0609","a77bb6e8-2578-4904-9083-86ecf9c1f0a7","0325ef1f-7bf7-47c3-9337-846fb5f115d1","e061616a-52e8-4895-bd2f-49c89f9c1955","90521391-4623-4551-b800-b337c6a1a061","82caae75-4984-4c43-859e-3a6fe07a31ca","ddb18a21-3c29-4770-9c25-4f7796632bb1","bdb4410f-b5e7-4e79-9d1e-68e2a64fe6e9","48df005d-f436-494a-921f-ad2be3388574","5a474382-e7cf-4ad9-8f12-e9a1bd2070a2","62c87db4-45b4-4366-8554-381f50f2f311","4963aee5-ffc5-4331-aff7-1a1e7f0c1aa9","5c17239d-019d-4ccf-8548-27cfa3c3d914","859a952e-c177-4636-8562-cb1663774fc2","143aa995-a6e5-4b83-b563-7caa81bc1927","7e233de2-23bc-4f0c-901c-4d575de8d41f","983ee778-1ecd-4f7d-a4ac-8c6414650094","23146840-d749-41b1-b8df-523c80c97f44","5d69ef31-acbb-41f1-bf02-ee223b7c3861","f88d2799-5621-41eb-92b0-27a14fef0ecf","cedc02cb-5096-4bbc-894e-279f88496648","29a3efb4-d59c-461a-939d-9732c7f1a467","a8ee382f-e2b1-4b9a-ade7-2375e182b3fd","c64bde7c-b595-43be-8d49-9b2218059933","5923a11f-5dc9-4905-87ca-5da3810c4806"],"space_id":"11f66c5f-6043-406b-b492-4dc267645668"}},"c5d58f05-b0cc-4b2b-b545-f1fd5df549fb":{"role":"reader","value":{"id":"c5d58f05-b0cc-4b2b-b545-f1fd5df549fb","version":38,"type":"table","name":"Table","format":{"table_properties":[{"width":455,"visible":true,"property":"title"},{"width":200,"visible":false,"property":";nHF"},{"width":200,"visible":false,"property":"Zq\u003e}"},{"width":200,"visible":false,"property":"s?]n"},{"width":200,"visible":false,"property":"VeZ_"},{"width":200,"visible":false,"property":"\u003e:DV"},{"width":200,"visible":false,"property":"rTD}"}]},"parent_id":"720fa796-e2d6-42db-ac52-1fee3d19addd","parent_table":"block","alive":true,"page_sort":["2d0a5101-7003-4092-9057-19b8afad5b47","549e0e14-1265-41ed-b0e8-6cd266e689f0","2cabcd1c-9b22-40e5-ac11-49c6807ab8f7","39be2719-fb58-49f3-a7fc-6d1c9ca86757","5d2d521a-e821-4acd-b0db-1e0ace950295","129181e5-5b2d-40a5-af60-47c125f075fd","455dfe03-94f5-4179-a5d7-528c072d34c4","08afc86f-001a-4e35-a008-dae3063a0609","a77bb6e8-2578-4904-9083-86ecf9c1f0a7","0325ef1f-7bf7-47c3-9337-846fb5f115d1","e061616a-52e8-4895-bd2f-49c89f9c1955","90521391-4623-4551-b800-b337c6a1a061","ddb18a21-3c29-4770-9c25-4f7796632bb1","bdb4410f-b5e7-4e79-9d1e-68e2a64fe6e9","48df005d-f436-494a-921f-ad2be3388574","5a474382-e7cf-4ad9-8f12-e9a1bd2070a2","62c87db4-45b4-4366-8554-381f50f2f311","4963aee5-ffc5-4331-aff7-1a1e7f0c1aa9","5c17239d-019d-4ccf-8548-27cfa3c3d914","859a952e-c177-4636-8562-cb1663774fc2","143aa995-a6e5-4b83-b563-7caa81bc1927","7e233de2-23bc-4f0c-901c-4d575de8d41f","983ee778-1ecd-4f7d-a4ac-8c6414650094","23146840-d749-41b1-b8df-523c80c97f44","5d69ef31-acbb-41f1-bf02-ee223b7c3861","f88d2799-5621-41eb-92b0-27a14fef0ecf","cedc02cb-5096-4bbc-894e-279f88496648","29a3efb4-d59c-461a-939d-9732c7f1a467","a8ee382f-e2b1-4b9a-ade7-2375e182b3fd","c64bde7c-b595-43be-8d49-9b2218059933","5923a11f-5dc9-4905-87ca-5da3810c4806","19be9c2d-64ff-4c8a-8135-571eb833f289","f035a5d3-a3cc-4c7f-a807-1ef1adf3d793"],"space_id":"11f66c5f-6043-406b-b492-4dc267645668"}}},"space":{},"notion_user":{},"collection_query":{},"signed_urls":{}}},"__N_SSG":true},"page":"/[pageId]","query":{"pageId":"143aa995a6e54b83b5637caa81bc1927"},"buildId":"8m1jH_cEAcI8D4q1R7pJI","assetPrefix":"/blog","runtimeConfig":{"basePath":"/blog"},"isFallback":false,"dynamicIds":[2679,8785],"gsp":true,"scriptLoader":[]}</script></body></html>