<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Minimal Life</title><meta name="description" content="Minimal Life Blog"/><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="5"/><link rel="preload" href="/blog/_next/static/css/ae2bf281c5f69f12.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/ae2bf281c5f69f12.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/dc36ea6314551c03.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/dc36ea6314551c03.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/blog/_next/static/chunks/webpack-4d5208940e01a3dc.js" defer=""></script><script src="/blog/_next/static/chunks/framework-00b57966872fc495.js" defer=""></script><script src="/blog/_next/static/chunks/main-04fa69cd18d105e9.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-f55443f2448c8e66.js" defer=""></script><script src="/blog/_next/static/chunks/247-b84c2316c963d09c.js" defer=""></script><script src="/blog/_next/static/chunks/pages/post/%5Bid%5D-6212bec497a425a5.js" defer=""></script><script src="/blog/_next/static/nI-FPMAkD-lkqK7BHpWJ6/_buildManifest.js" defer=""></script><script src="/blog/_next/static/nI-FPMAkD-lkqK7BHpWJ6/_ssgManifest.js" defer=""></script><script src="/blog/_next/static/nI-FPMAkD-lkqK7BHpWJ6/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="Layout_container__KdNo5"><header class="Layout_header__TY1Ur"><div class="Avatar_avatar__Wqsgs"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2724%27%20height=%2724%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="Avatar_img__fPm7S" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://avatars.githubusercontent.com/u/17166940?v=4 1x, https://avatars.githubusercontent.com/u/17166940?v=4 2x" src="https://avatars.githubusercontent.com/u/17166940?v=4" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="Avatar_img__fPm7S" loading="lazy"/></noscript></span><div class="Avatar_username__94Fmm">phshy0607</div></div><div class="Navbar_navbar__dE_dF"><nav class="Navbar_nav__lgcdH"><a href="/blog">Home</a></nav><nav class="Navbar_nav__lgcdH"><a href="/blog/posts">Posts</a></nav></div></header><main class="Layout_main__CO5d2"><div class="markdown-body scroller"><h1 dir="auto">React学习与探索之路 (三) - Dark Mode with Styled Components</h1>
<h2 dir="auto">一点想法</h2>
<p dir="auto">看到 Styled Components 文档里的一些高级特性，其中有一项是ThemeProvider，便萌生出使用他完成类似之前IOS上Night Shift的功能，也就是Dark Mode.</p>
<h2 dir="auto">实现</h2>
<h3 dir="auto">放置ThemeProvider</h3>
<p dir="auto">Dark Mode影响的范围应该涉及 Login 页面以及 Dashboard. 所以ThemeProvider应该在这2个组件之上。</p>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;ThemeProvider theme={this.state.theme}&gt;
  {
    isAuthenticated ? &lt;Login/&gt; : &lt;Dashboard/&gt;
  }
&lt;/ThemeProvider&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-ent">ThemeProvider</span> <span class="pl-c1">theme</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">state</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">}</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">{</span>
    <span class="pl-s1">isAuthenticated</span> ? <span class="pl-c1">&lt;</span><span class="pl-ent">Login</span><span class="pl-c1">/</span><span class="pl-c1">&gt;</span> : <span class="pl-c1">&lt;</span><span class="pl-ent">Dashboard</span><span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">}</span>
<span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">ThemeProvider</span><span class="pl-c1">&gt;</span></pre></div>
<p dir="auto">theme对象目前会有一个dark的Boolean属性对Dark Mode进行控制，UI层面上会提供一个Switch来进行模式的切换</p>
<h3 dir="auto">Dark Mode的状态管理</h3>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="this.state.theme = {
  dark: false
}

// 定义handleDarkModeChange函数
handleDarkModeChange () {
  this.setState((prev) =&gt; {
    return {
      theme: {
        dark: !prev.theme.dark
      }
    }
  })
}

render () {
  return (
    // 传入子组件
    &lt;ThemeProvider theme={this.state.theme}&gt;
      {
        isAuthenticated ? 
          &lt;Login handleDarkModeChange={this.handleDarkModeChange}/&gt; : 
          &lt;Dashboard handleDarkModeChange={this.handleDarkModeChange}/&gt;
      }
    &lt;/ThemeProvider&gt;
  )
}"><pre><span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">state</span><span class="pl-kos">.</span><span class="pl-c1">theme</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
  <span class="pl-c1">dark</span>: <span class="pl-c1">false</span>
<span class="pl-kos">}</span>

<span class="pl-c">// 定义handleDarkModeChange函数</span>
<span class="pl-en">handleDarkModeChange</span> <span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos"></span> <span class="pl-kos">{</span>
  <span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-en">setState</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">prev</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">return</span> <span class="pl-kos">{</span>
      <span class="pl-c1">theme</span>: <span class="pl-kos">{</span>
        <span class="pl-c1">dark</span>: <span class="pl-c1">!</span><span class="pl-s1">prev</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span>
      <span class="pl-kos">}</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">)</span>
<span class="pl-kos">}</span>

<span class="pl-en">render</span> <span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos"></span> <span class="pl-kos">{</span>
  <span class="pl-k">return</span> <span class="pl-kos">(</span>
    <span class="pl-c">// 传入子组件</span>
    <span class="pl-c1">&lt;</span><span class="pl-ent">ThemeProvider</span> <span class="pl-c1">theme</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">state</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">}</span><span class="pl-c1">&gt;</span>
      <span class="pl-kos">{</span>
        <span class="pl-s1">isAuthenticated</span> ? 
          <span class="pl-c1">&lt;</span><span class="pl-ent">Login</span> <span class="pl-c1">handleDarkModeChange</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">handleDarkModeChange</span><span class="pl-kos">}</span><span class="pl-c1">/</span><span class="pl-c1">&gt;</span> : 
          <span class="pl-c1">&lt;</span><span class="pl-ent">Dashboard</span> <span class="pl-c1">handleDarkModeChange</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">handleDarkModeChange</span><span class="pl-kos">}</span><span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
      <span class="pl-kos">}</span>
    <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">ThemeProvider</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">)</span>
<span class="pl-kos">}</span></pre></div>
<h3 dir="auto">Dark Mode 的 CSS 实现</h3>
<p dir="auto">在样式方面，使用Styled Component的传参功能对样式进行修改</p>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="const StyledDashboardRoot = styled(StyledDiv)`
  color: ${props =&gt; props.theme.dark ? 'white' : 'black'};
  background-color: ${props =&gt; props.theme.dark ? '#f7f7f7' : '#282c34'};
  transition: background-color 200ms linear, color 200ms linear;
  ...略

  .MuiListItemIcon-root {
    color: ${props =&gt; props.theme.dark ? 'white' : 'black'};
  }

  .MuiListSubheader-root {
    color: ${props =&gt; props.theme.dark ? 'white' : 'black'};
    opacity: 0.8;
  }

  .MuiDivider-root {
    background-color: ${props =&gt; props.theme.dark ? '#f7f7f7' : undefined};
    opacity: ${props =&gt; props.theme.dark ? '0.1' : undefined};
  }

  .dashboard-main {
    background-color: ${props =&gt; props.theme.dark ? '#282c34' : '#f7f7f7'};
    height: 100%;
    ...略
  }
`"><pre><span class="pl-k">const</span> <span class="pl-v">StyledDashboardRoot</span> <span class="pl-c1">=</span> <span class="pl-en">styled</span><span class="pl-kos">(</span><span class="pl-v">StyledDiv</span><span class="pl-kos">)</span><span class="pl-s">`</span>
<span class="pl-s">  color: <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">props</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span> ? <span class="pl-s">'white'</span> : <span class="pl-s">'black'</span><span class="pl-kos">}</span></span>;</span>
<span class="pl-s">  background-color: <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">props</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span> ? <span class="pl-s">'#f7f7f7'</span> : <span class="pl-s">'#282c34'</span><span class="pl-kos">}</span></span>;</span>
<span class="pl-s">  transition: background-color 200ms linear, color 200ms linear;</span>
<span class="pl-s">  ...略</span>
<span class="pl-s"></span>
<span class="pl-s">  .MuiListItemIcon-root {</span>
<span class="pl-s">    color: <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">props</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span> ? <span class="pl-s">'white'</span> : <span class="pl-s">'black'</span><span class="pl-kos">}</span></span>;</span>
<span class="pl-s">  }</span>
<span class="pl-s"></span>
<span class="pl-s">  .MuiListSubheader-root {</span>
<span class="pl-s">    color: <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">props</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span> ? <span class="pl-s">'white'</span> : <span class="pl-s">'black'</span><span class="pl-kos">}</span></span>;</span>
<span class="pl-s">    opacity: 0.8;</span>
<span class="pl-s">  }</span>
<span class="pl-s"></span>
<span class="pl-s">  .MuiDivider-root {</span>
<span class="pl-s">    background-color: <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">props</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span> ? <span class="pl-s">'#f7f7f7'</span> : <span class="pl-c1">undefined</span><span class="pl-kos">}</span></span>;</span>
<span class="pl-s">    opacity: <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">props</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span> ? <span class="pl-s">'0.1'</span> : <span class="pl-c1">undefined</span><span class="pl-kos">}</span></span>;</span>
<span class="pl-s">  }</span>
<span class="pl-s"></span>
<span class="pl-s">  .dashboard-main {</span>
<span class="pl-s">    background-color: <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">props</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span> ? <span class="pl-s">'#282c34'</span> : <span class="pl-s">'#f7f7f7'</span><span class="pl-kos">}</span></span>;</span>
<span class="pl-s">    height: 100%;</span>
<span class="pl-s">    ...略</span>
<span class="pl-s">  }</span>
<span class="pl-s">`</span></pre></div>
<p dir="auto">大致的实现就是黑暗模式下，背景色为暗色，主色调为亮色。�</p>
<h3 dir="auto">使用Switch组件控制Dark Mode</h3>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;Switch
  checked={this.props.theme.dark}
  onChange={(event) =&gt; this.props.handleDarkModeChange(event.target.value)}
  color=&quot;default&quot;
  size=&quot;small&quot;
/&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-ent">Switch</span>
  <span class="pl-c1">checked</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">props</span><span class="pl-kos">.</span><span class="pl-c1">theme</span><span class="pl-kos">.</span><span class="pl-c1">dark</span><span class="pl-kos">}</span>
  <span class="pl-c1">onChange</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">(</span><span class="pl-s1">event</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">props</span><span class="pl-kos">.</span><span class="pl-en">handleDarkModeChange</span><span class="pl-kos">(</span><span class="pl-s1">event</span><span class="pl-kos">.</span><span class="pl-c1">target</span><span class="pl-kos">.</span><span class="pl-c1">value</span><span class="pl-kos">)</span><span class="pl-kos">}</span>
  <span class="pl-c1">color</span><span class="pl-c1">=</span><span class="pl-s">"default"</span>
  <span class="pl-c1">size</span><span class="pl-c1">=</span><span class="pl-s">"small"</span>
<span class="pl-c1">/</span><span class="pl-c1">&gt;</span></pre></div>
<p dir="auto">可以看到这里的theme是从this.props里读取的，那也就是theme对象需要注入到组件级别，这里可以使用Styled-Components库提供的withTheme的高阶组件</p>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="withTheme(Navbar)"><pre><span class="pl-en">withTheme</span><span class="pl-kos">(</span><span class="pl-v">Navbar</span><span class="pl-kos">)</span></pre></div>
<p dir="auto">以上涉及了Provider的概念，具体Styled Components的传参功能，ThemeProvider和withTheme HOC的运用。</p></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"html":"\u003ch1 dir=\"auto\"\u003eReact学习与探索之路 (三) - Dark Mode with Styled Components\u003c/h1\u003e\n\u003ch2 dir=\"auto\"\u003e一点想法\u003c/h2\u003e\n\u003cp dir=\"auto\"\u003e看到 Styled Components 文档里的一些高级特性，其中有一项是ThemeProvider，便萌生出使用他完成类似之前IOS上Night Shift的功能，也就是Dark Mode.\u003c/p\u003e\n\u003ch2 dir=\"auto\"\u003e实现\u003c/h2\u003e\n\u003ch3 dir=\"auto\"\u003e放置ThemeProvider\u003c/h3\u003e\n\u003cp dir=\"auto\"\u003eDark Mode影响的范围应该涉及 Login 页面以及 Dashboard. 所以ThemeProvider应该在这2个组件之上。\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;ThemeProvider theme={this.state.theme}\u0026gt;\n  {\n    isAuthenticated ? \u0026lt;Login/\u0026gt; : \u0026lt;Dashboard/\u0026gt;\n  }\n\u0026lt;/ThemeProvider\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eThemeProvider\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003estate\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-s1\"\u003eisAuthenticated\u003c/span\u003e ? \u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eLogin\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e : \u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eDashboard\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eThemeProvider\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003etheme对象目前会有一个dark的Boolean属性对Dark Mode进行控制，UI层面上会提供一个Switch来进行模式的切换\u003c/p\u003e\n\u003ch3 dir=\"auto\"\u003eDark Mode的状态管理\u003c/h3\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"this.state.theme = {\n  dark: false\n}\n\n// 定义handleDarkModeChange函数\nhandleDarkModeChange () {\n  this.setState((prev) =\u0026gt; {\n    return {\n      theme: {\n        dark: !prev.theme.dark\n      }\n    }\n  })\n}\n\nrender () {\n  return (\n    // 传入子组件\n    \u0026lt;ThemeProvider theme={this.state.theme}\u0026gt;\n      {\n        isAuthenticated ? \n          \u0026lt;Login handleDarkModeChange={this.handleDarkModeChange}/\u0026gt; : \n          \u0026lt;Dashboard handleDarkModeChange={this.handleDarkModeChange}/\u0026gt;\n      }\n    \u0026lt;/ThemeProvider\u0026gt;\n  )\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003estate\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003efalse\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e// 定义handleDarkModeChange函数\u003c/span\u003e\n\u003cspan class=\"pl-en\"\u003ehandleDarkModeChange\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esetState\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprev\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003e!\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprev\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"pl-en\"\u003erender\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e// 传入子组件\u003c/span\u003e\n    \u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eThemeProvider\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003estate\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"pl-s1\"\u003eisAuthenticated\u003c/span\u003e ? \n          \u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eLogin\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ehandleDarkModeChange\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ehandleDarkModeChange\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e : \n          \u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eDashboard\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ehandleDarkModeChange\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ehandleDarkModeChange\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eThemeProvider\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 dir=\"auto\"\u003eDark Mode 的 CSS 实现\u003c/h3\u003e\n\u003cp dir=\"auto\"\u003e在样式方面，使用Styled Component的传参功能对样式进行修改\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"const StyledDashboardRoot = styled(StyledDiv)`\n  color: ${props =\u0026gt; props.theme.dark ? 'white' : 'black'};\n  background-color: ${props =\u0026gt; props.theme.dark ? '#f7f7f7' : '#282c34'};\n  transition: background-color 200ms linear, color 200ms linear;\n  ...略\n\n  .MuiListItemIcon-root {\n    color: ${props =\u0026gt; props.theme.dark ? 'white' : 'black'};\n  }\n\n  .MuiListSubheader-root {\n    color: ${props =\u0026gt; props.theme.dark ? 'white' : 'black'};\n    opacity: 0.8;\n  }\n\n  .MuiDivider-root {\n    background-color: ${props =\u0026gt; props.theme.dark ? '#f7f7f7' : undefined};\n    opacity: ${props =\u0026gt; props.theme.dark ? '0.1' : undefined};\n  }\n\n  .dashboard-main {\n    background-color: ${props =\u0026gt; props.theme.dark ? '#282c34' : '#f7f7f7'};\n    height: 100%;\n    ...略\n  }\n`\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003econst\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eStyledDashboardRoot\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003estyled\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eStyledDiv\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e`\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  color: \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-kos\"\u003e${\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e ? \u003cspan class=\"pl-s\"\u003e'white'\u003c/span\u003e : \u003cspan class=\"pl-s\"\u003e'black'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  background-color: \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-kos\"\u003e${\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e ? \u003cspan class=\"pl-s\"\u003e'#f7f7f7'\u003c/span\u003e : \u003cspan class=\"pl-s\"\u003e'#282c34'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  transition: background-color 200ms linear, color 200ms linear;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  ...略\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  .MuiListItemIcon-root {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    color: \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-kos\"\u003e${\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e ? \u003cspan class=\"pl-s\"\u003e'white'\u003c/span\u003e : \u003cspan class=\"pl-s\"\u003e'black'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  }\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  .MuiListSubheader-root {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    color: \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-kos\"\u003e${\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e ? \u003cspan class=\"pl-s\"\u003e'white'\u003c/span\u003e : \u003cspan class=\"pl-s\"\u003e'black'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    opacity: 0.8;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  }\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  .MuiDivider-root {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    background-color: \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-kos\"\u003e${\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e ? \u003cspan class=\"pl-s\"\u003e'#f7f7f7'\u003c/span\u003e : \u003cspan class=\"pl-c1\"\u003eundefined\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    opacity: \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-kos\"\u003e${\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e ? \u003cspan class=\"pl-s\"\u003e'0.1'\u003c/span\u003e : \u003cspan class=\"pl-c1\"\u003eundefined\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  }\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  .dashboard-main {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    background-color: \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-kos\"\u003e${\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e ? \u003cspan class=\"pl-s\"\u003e'#282c34'\u003c/span\u003e : \u003cspan class=\"pl-s\"\u003e'#f7f7f7'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    height: 100%;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    ...略\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e  }\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e`\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e大致的实现就是黑暗模式下，背景色为暗色，主色调为亮色。�\u003c/p\u003e\n\u003ch3 dir=\"auto\"\u003e使用Switch组件控制Dark Mode\u003c/h3\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;Switch\n  checked={this.props.theme.dark}\n  onChange={(event) =\u0026gt; this.props.handleDarkModeChange(event.target.value)}\n  color=\u0026quot;default\u0026quot;\n  size=\u0026quot;small\u0026quot;\n/\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eSwitch\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003echecked\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edark\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003eonChange\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eevent\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eprops\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ehandleDarkModeChange\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eevent\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etarget\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003ecolor\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"default\"\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003esize\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"small\"\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e可以看到这里的theme是从this.props里读取的，那也就是theme对象需要注入到组件级别，这里可以使用Styled-Components库提供的withTheme的高阶组件\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"withTheme(Navbar)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-en\"\u003ewithTheme\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eNavbar\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e以上涉及了Provider的概念，具体Styled Components的传参功能，ThemeProvider和withTheme HOC的运用。\u003c/p\u003e"},"__N_SSG":true},"page":"/post/[id]","query":{"id":"14,13,12"},"buildId":"nI-FPMAkD-lkqK7BHpWJ6","assetPrefix":"/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>