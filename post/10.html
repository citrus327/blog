<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Minimal Life</title><meta name="description" content="Minimal Life Blog"/><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="5"/><link rel="preload" href="/blog/_next/static/css/6db3845f9f3a867b.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/6db3845f9f3a867b.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/452f28fbf231f2d9.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/452f28fbf231f2d9.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/blog/_next/static/chunks/webpack-4d5208940e01a3dc.js" defer=""></script><script src="/blog/_next/static/chunks/framework-00b57966872fc495.js" defer=""></script><script src="/blog/_next/static/chunks/main-04fa69cd18d105e9.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-f55443f2448c8e66.js" defer=""></script><script src="/blog/_next/static/chunks/247-b84c2316c963d09c.js" defer=""></script><script src="/blog/_next/static/chunks/pages/post/%5Bid%5D-5f7ac47925745e56.js" defer=""></script><script src="/blog/_next/static/2tlN5wIyob5M_gw9gxPwR/_buildManifest.js" defer=""></script><script src="/blog/_next/static/2tlN5wIyob5M_gw9gxPwR/_ssgManifest.js" defer=""></script><script src="/blog/_next/static/2tlN5wIyob5M_gw9gxPwR/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="Layout_container__KdNo5"><header class="Layout_header__TY1Ur"><div class="Avatar_avatar__Wqsgs"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2724%27%20height=%2724%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="Avatar_img__fPm7S" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://avatars.githubusercontent.com/u/17166940?v=4 1x, https://avatars.githubusercontent.com/u/17166940?v=4 2x" src="https://avatars.githubusercontent.com/u/17166940?v=4" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="Avatar_img__fPm7S" loading="lazy"/></noscript></span><div class="Avatar_username__94Fmm">phshy0607</div></div><div class="Navbar_navbar__dE_dF"><nav class="Navbar_nav__lgcdH"><a href="/blog">Home</a></nav><nav class="Navbar_nav__lgcdH"><a href="/blog/posts">Posts</a></nav></div></header><main class="Layout_main__CO5d2"><div class="markdown-body"><h1 dir="auto">Object.defineProperty的一点想法和解读</h1>
<blockquote>
<p dir="auto">之前只能兼容IE8，现在可以兼容到IE11了，可以在日常中使用Object.defineProperty了<br>
看到有人用Object.defineProperty去实现了常量定义，觉得很有意思，在这分享一下。</p>
</blockquote>
<p dir="auto"><code class="notranslate">Object.defineProperty</code>是可以对对象本身进行设置的方法。除了常见的对对象进行数据劫持的用法之外，<br>
最基本的四个属性是可以做到保证属性不被任何改动影响的。</p>
<p dir="auto">创建一个空的对象。为了保证这个常量对象的纯粹，我们让这个对象的原型为null</p>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="let constant = Object.create(null)"><pre><span class="pl-k">let</span> <span class="pl-s1">constant</span> <span class="pl-c1">=</span> <span class="pl-v">Object</span><span class="pl-kos">.</span><span class="pl-en">create</span><span class="pl-kos">(</span><span class="pl-c1">null</span><span class="pl-kos">)</span></pre></div>
<p dir="auto">为了保证这个常量下的任意Key-value值，在定义完之后，不可变动，我们可以采用Object.defineProperty对其赋值。</p>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="Object.defineProperty(constant, &quot;MY_CONSTANT&quot;, {
  enumerable: true, // 可以被枚举
  configurable: false, // 不可以删除和设置该属性
  writable: false, // 不可以重写
  value: &quot;MY_CONSTANT_VALUE&quot;
})"><pre><span class="pl-v">Object</span><span class="pl-kos">.</span><span class="pl-en">defineProperty</span><span class="pl-kos">(</span><span class="pl-s1">constant</span><span class="pl-kos">,</span> <span class="pl-s">"MY_CONSTANT"</span><span class="pl-kos">,</span> <span class="pl-kos">{</span>
  <span class="pl-c1">enumerable</span>: <span class="pl-c1">true</span><span class="pl-kos">,</span> <span class="pl-c">// 可以被枚举</span>
  <span class="pl-c1">configurable</span>: <span class="pl-c1">false</span><span class="pl-kos">,</span> <span class="pl-c">// 不可以删除和设置该属性</span>
  <span class="pl-c1">writable</span>: <span class="pl-c1">false</span><span class="pl-kos">,</span> <span class="pl-c">// 不可以重写</span>
  <span class="pl-c1">value</span>: <span class="pl-s">"MY_CONSTANT_VALUE"</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span></pre></div>
<p dir="auto">这里有4个值，</p>
<ol dir="auto">
<li><code class="notranslate">enumerable</code>: 是否可以被<code class="notranslate">for...in</code>和<code class="notranslate">Object.keys()</code>枚举。</li>
<li><code class="notranslate">configurable</code>: 是否可以删除该key值，同时控制 "能否再次对该key值进行<code class="notranslate">Object.defineProperty</code>"的能力。</li>
<li><code class="notranslate">writable</code>: 是否可以对该key值对应的value值重新赋值。</li>
<li><code class="notranslate">value</code>: value值本身</li>
</ol>
<p dir="auto">关于enumerbale, <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Enumerability_and_ownership_of_properties" rel="nofollow">MDN</a>上有很大篇幅的描述：</p>
<p dir="auto">所以在对对象constant下的MY_CONSTANT这个属性进行Object.defineProperty之后，任何操作都无法更改该key-value值，启到常量的作用。</p>
<p dir="auto">这对于一般常量使用来说，可能是一种overkill，但是设计思路值得一看。</p></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"html":"\u003ch1 dir=\"auto\"\u003eObject.defineProperty的一点想法和解读\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e之前只能兼容IE8，现在可以兼容到IE11了，可以在日常中使用Object.defineProperty了\u003cbr\u003e\n看到有人用Object.defineProperty去实现了常量定义，觉得很有意思，在这分享一下。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode class=\"notranslate\"\u003eObject.defineProperty\u003c/code\u003e是可以对对象本身进行设置的方法。除了常见的对对象进行数据劫持的用法之外，\u003cbr\u003e\n最基本的四个属性是可以做到保证属性不被任何改动影响的。\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e创建一个空的对象。为了保证这个常量对象的纯粹，我们让这个对象的原型为null\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"let constant = Object.create(null)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003elet\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003econstant\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eObject\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ecreate\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e为了保证这个常量下的任意Key-value值，在定义完之后，不可变动，我们可以采用Object.defineProperty对其赋值。\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Object.defineProperty(constant, \u0026quot;MY_CONSTANT\u0026quot;, {\n  enumerable: true, // 可以被枚举\n  configurable: false, // 不可以删除和设置该属性\n  writable: false, // 不可以重写\n  value: \u0026quot;MY_CONSTANT_VALUE\u0026quot;\n})\"\u003e\u003cpre\u003e\u003cspan class=\"pl-v\"\u003eObject\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003edefineProperty\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003econstant\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"MY_CONSTANT\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003eenumerable\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e// 可以被枚举\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003econfigurable\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003efalse\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e// 不可以删除和设置该属性\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003ewritable\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003efalse\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e// 不可以重写\u003c/span\u003e\n  \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"MY_CONSTANT_VALUE\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e这里有4个值，\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode class=\"notranslate\"\u003eenumerable\u003c/code\u003e: 是否可以被\u003ccode class=\"notranslate\"\u003efor...in\u003c/code\u003e和\u003ccode class=\"notranslate\"\u003eObject.keys()\u003c/code\u003e枚举。\u003c/li\u003e\n\u003cli\u003e\u003ccode class=\"notranslate\"\u003econfigurable\u003c/code\u003e: 是否可以删除该key值，同时控制 \"能否再次对该key值进行\u003ccode class=\"notranslate\"\u003eObject.defineProperty\u003c/code\u003e\"的能力。\u003c/li\u003e\n\u003cli\u003e\u003ccode class=\"notranslate\"\u003ewritable\u003c/code\u003e: 是否可以对该key值对应的value值重新赋值。\u003c/li\u003e\n\u003cli\u003e\u003ccode class=\"notranslate\"\u003evalue\u003c/code\u003e: value值本身\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e关于enumerbale, \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Enumerability_and_ownership_of_properties\" rel=\"nofollow\"\u003eMDN\u003c/a\u003e上有很大篇幅的描述：\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e所以在对对象constant下的MY_CONSTANT这个属性进行Object.defineProperty之后，任何操作都无法更改该key-value值，启到常量的作用。\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e这对于一般常量使用来说，可能是一种overkill，但是设计思路值得一看。\u003c/p\u003e"},"__N_SSG":true},"page":"/post/[id]","query":{"id":"10"},"buildId":"2tlN5wIyob5M_gw9gxPwR","assetPrefix":"/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>